{
    "id": "ALPINE-CVE-2021-3711",
    "details": "In order to decrypt SM2 encrypted data an application is expected to call the API function EVP_PKEY_decrypt(). Typically an application will call this function twice. The first time, on entry, the \"out\" parameter can be NULL and, on exit, the \"outlen\" parameter is populated with the buffer size required to hold the decrypted plaintext. The application can then allocate a sufficiently sized buffer and call EVP_PKEY_decrypt() again, but this time passing a non-NULL value for the \"out\" parameter. A bug in the implementation of the SM2 decryption code means that the calculation of the buffer size required to hold the plaintext returned by the first call to EVP_PKEY_decrypt() can be smaller than the actual size required by the second call. This can lead to a buffer overflow when EVP_PKEY_decrypt() is called by the application a second time with a buffer that is too small. A malicious attacker who is able present SM2 content for decryption to an application could cause attacker chosen data to overflow the buffer by up to a maximum of 62 bytes altering the contents of other data held after the buffer, possibly changing application behaviour or causing the application to crash. The location of the buffer is application dependent but is typically heap allocated. Fixed in OpenSSL 1.1.1l (Affected 1.1.1-1.1.1k).",
    "modified": "2025-12-03T22:48:47.560805Z",
    "published": "2021-08-24T15:15:09.133Z",
    "upstream": [
        "CVE-2021-3711"
    ],
    "references": [
        {
            "type": "ADVISORY",
            "url": "https://security.alpinelinux.org/vuln/CVE-2021-3711"
        }
    ],
    "affected": [
        {
            "package": {
                "name": "openssl",
                "ecosystem": "Alpine:v3.11",
                "purl": "pkg:apk/alpine/openssl?arch=source"
            },
            "ranges": [
                {
                    "type": "ECOSYSTEM",
                    "events": [
                        {
                            "introduced": "0"
                        },
                        {
                            "fixed": "1.1.1l-r0"
                        }
                    ]
                }
            ],
            "versions": [
                "1.1.1-r1",
                "1.1.1-r2",
                "1.1.1-r3",
                "1.1.1-r4",
                "1.1.1-r5",
                "1.1.1a-r0",
                "1.1.1a-r1",
                "1.1.1b-r0",
                "1.1.1b-r1",
                "1.1.1c-r0",
                "1.1.1c-r1",
                "1.1.1d-r1",
                "1.1.1d-r2",
                "1.1.1d-r3",
                "1.1.1g-r0",
                "1.1.1i-r0",
                "1.1.1j-r0",
                "1.1.1k-r0"
            ],
            "database_specific": {
                "source": "https://storage.googleapis.com/cve-osv-conversion/alpine/ALPINE-CVE-2021-3711.json"
            }
        },
        {
            "package": {
                "name": "openssl",
                "ecosystem": "Alpine:v3.12",
                "purl": "pkg:apk/alpine/openssl?arch=source"
            },
            "ranges": [
                {
                    "type": "ECOSYSTEM",
                    "events": [
                        {
                            "introduced": "0"
                        },
                        {
                            "fixed": "1.1.1l-r0"
                        }
                    ]
                }
            ],
            "versions": [
                "1.1.1-r1",
                "1.1.1-r2",
                "1.1.1-r3",
                "1.1.1-r4",
                "1.1.1-r5",
                "1.1.1a-r0",
                "1.1.1a-r1",
                "1.1.1b-r0",
                "1.1.1b-r1",
                "1.1.1c-r0",
                "1.1.1c-r1",
                "1.1.1d-r1",
                "1.1.1d-r2",
                "1.1.1d-r3",
                "1.1.1d-r4",
                "1.1.1d-r5",
                "1.1.1e-r0",
                "1.1.1f-r0",
                "1.1.1g-r0",
                "1.1.1h-r0",
                "1.1.1i-r0",
                "1.1.1j-r0",
                "1.1.1k-r0"
            ],
            "database_specific": {
                "source": "https://storage.googleapis.com/cve-osv-conversion/alpine/ALPINE-CVE-2021-3711.json"
            }
        },
        {
            "package": {
                "name": "openssl",
                "ecosystem": "Alpine:v3.13",
                "purl": "pkg:apk/alpine/openssl?arch=source"
            },
            "ranges": [
                {
                    "type": "ECOSYSTEM",
                    "events": [
                        {
                            "introduced": "0"
                        },
                        {
                            "fixed": "1.1.1l-r0"
                        }
                    ]
                }
            ],
            "versions": [
                "1.1.1-r1",
                "1.1.1-r2",
                "1.1.1-r3",
                "1.1.1-r4",
                "1.1.1-r5",
                "1.1.1a-r0",
                "1.1.1a-r1",
                "1.1.1b-r0",
                "1.1.1b-r1",
                "1.1.1c-r0",
                "1.1.1c-r1",
                "1.1.1d-r1",
                "1.1.1d-r2",
                "1.1.1d-r3",
                "1.1.1d-r4",
                "1.1.1d-r5",
                "1.1.1e-r0",
                "1.1.1f-r0",
                "1.1.1g-r0",
                "1.1.1h-r0",
                "1.1.1i-r0",
                "1.1.1j-r0",
                "1.1.1k-r0"
            ],
            "database_specific": {
                "source": "https://storage.googleapis.com/cve-osv-conversion/alpine/ALPINE-CVE-2021-3711.json"
            }
        },
        {
            "package": {
                "name": "openssl",
                "ecosystem": "Alpine:v3.14",
                "purl": "pkg:apk/alpine/openssl?arch=source"
            },
            "ranges": [
                {
                    "type": "ECOSYSTEM",
                    "events": [
                        {
                            "introduced": "0"
                        },
                        {
                            "fixed": "1.1.1l-r0"
                        }
                    ]
                }
            ],
            "versions": [
                "1.1.1-r1",
                "1.1.1-r2",
                "1.1.1-r3",
                "1.1.1-r4",
                "1.1.1-r5",
                "1.1.1a-r0",
                "1.1.1a-r1",
                "1.1.1b-r0",
                "1.1.1b-r1",
                "1.1.1c-r0",
                "1.1.1c-r1",
                "1.1.1d-r1",
                "1.1.1d-r2",
                "1.1.1d-r3",
                "1.1.1d-r4",
                "1.1.1d-r5",
                "1.1.1e-r0",
                "1.1.1f-r0",
                "1.1.1g-r0",
                "1.1.1h-r0",
                "1.1.1i-r0",
                "1.1.1j-r0",
                "1.1.1k-r0"
            ],
            "database_specific": {
                "source": "https://storage.googleapis.com/cve-osv-conversion/alpine/ALPINE-CVE-2021-3711.json"
            }
        },
        {
            "package": {
                "name": "openssl",
                "ecosystem": "Alpine:v3.15",
                "purl": "pkg:apk/alpine/openssl?arch=source"
            },
            "ranges": [
                {
                    "type": "ECOSYSTEM",
                    "events": [
                        {
                            "introduced": "0"
                        },
                        {
                            "fixed": "1.1.1l-r0"
                        }
                    ]
                }
            ],
            "database_specific": {
                "source": "https://storage.googleapis.com/cve-osv-conversion/alpine/ALPINE-CVE-2021-3711.json"
            }
        },
        {
            "package": {
                "name": "openssl",
                "ecosystem": "Alpine:v3.16",
                "purl": "pkg:apk/alpine/openssl?arch=source"
            },
            "ranges": [
                {
                    "type": "ECOSYSTEM",
                    "events": [
                        {
                            "introduced": "0"
                        },
                        {
                            "fixed": "1.1.1l-r0"
                        }
                    ]
                }
            ],
            "database_specific": {
                "source": "https://storage.googleapis.com/cve-osv-conversion/alpine/ALPINE-CVE-2021-3711.json"
            }
        },
        {
            "package": {
                "name": "openssl",
                "ecosystem": "Alpine:v3.17",
                "purl": "pkg:apk/alpine/openssl?arch=source"
            },
            "ranges": [
                {
                    "type": "ECOSYSTEM",
                    "events": [
                        {
                            "introduced": "0"
                        },
                        {
                            "fixed": "1.1.1l-r0"
                        }
                    ]
                }
            ],
            "versions": [
                "1.1.1-r0",
                "1.1.1-r1",
                "1.1.1-r2",
                "1.1.1-r3",
                "1.1.1-r4",
                "1.1.1-r5",
                "1.1.1a-r0",
                "1.1.1a-r1",
                "1.1.1b-r0",
                "1.1.1b-r1",
                "1.1.1c-r0",
                "1.1.1c-r1",
                "1.1.1d-r1",
                "1.1.1d-r2",
                "1.1.1d-r3",
                "1.1.1d-r4",
                "1.1.1d-r5",
                "1.1.1e-r0",
                "1.1.1f-r0",
                "1.1.1g-r0",
                "1.1.1h-r0",
                "1.1.1i-r0",
                "1.1.1j-r0",
                "1.1.1k-r0",
                "1.1.1k-r1"
            ],
            "database_specific": {
                "source": "https://storage.googleapis.com/cve-osv-conversion/alpine/ALPINE-CVE-2021-3711.json"
            }
        },
        {
            "package": {
                "name": "openssl",
                "ecosystem": "Alpine:v3.18",
                "purl": "pkg:apk/alpine/openssl?arch=source"
            },
            "ranges": [
                {
                    "type": "ECOSYSTEM",
                    "events": [
                        {
                            "introduced": "0"
                        },
                        {
                            "fixed": "1.1.1l-r0"
                        }
                    ]
                }
            ],
            "versions": [
                "1.1.1-r0",
                "1.1.1-r1",
                "1.1.1-r2",
                "1.1.1-r3",
                "1.1.1-r4",
                "1.1.1-r5",
                "1.1.1a-r0",
                "1.1.1a-r1",
                "1.1.1b-r0",
                "1.1.1b-r1",
                "1.1.1c-r0",
                "1.1.1c-r1",
                "1.1.1d-r1",
                "1.1.1d-r2",
                "1.1.1d-r3",
                "1.1.1d-r4",
                "1.1.1d-r5",
                "1.1.1e-r0",
                "1.1.1f-r0",
                "1.1.1g-r0",
                "1.1.1h-r0",
                "1.1.1i-r0",
                "1.1.1j-r0",
                "1.1.1k-r0",
                "1.1.1k-r1"
            ],
            "database_specific": {
                "source": "https://storage.googleapis.com/cve-osv-conversion/alpine/ALPINE-CVE-2021-3711.json"
            }
        },
        {
            "package": {
                "name": "openssl",
                "ecosystem": "Alpine:v3.19",
                "purl": "pkg:apk/alpine/openssl?arch=source"
            },
            "ranges": [
                {
                    "type": "ECOSYSTEM",
                    "events": [
                        {
                            "introduced": "0"
                        },
                        {
                            "fixed": "1.1.1l-r0"
                        }
                    ]
                }
            ],
            "versions": [
                "1.1.1-r0",
                "1.1.1-r1",
                "1.1.1-r2",
                "1.1.1-r3",
                "1.1.1-r4",
                "1.1.1-r5",
                "1.1.1a-r0",
                "1.1.1a-r1",
                "1.1.1b-r0",
                "1.1.1b-r1",
                "1.1.1c-r0",
                "1.1.1c-r1",
                "1.1.1d-r1",
                "1.1.1d-r2",
                "1.1.1d-r3",
                "1.1.1d-r4",
                "1.1.1d-r5",
                "1.1.1e-r0",
                "1.1.1f-r0",
                "1.1.1g-r0",
                "1.1.1h-r0",
                "1.1.1i-r0",
                "1.1.1j-r0",
                "1.1.1k-r0",
                "1.1.1k-r1"
            ],
            "database_specific": {
                "source": "https://storage.googleapis.com/cve-osv-conversion/alpine/ALPINE-CVE-2021-3711.json"
            }
        },
        {
            "package": {
                "name": "openssl",
                "ecosystem": "Alpine:v3.20",
                "purl": "pkg:apk/alpine/openssl?arch=source"
            },
            "ranges": [
                {
                    "type": "ECOSYSTEM",
                    "events": [
                        {
                            "introduced": "0"
                        },
                        {
                            "fixed": "1.1.1l-r0"
                        }
                    ]
                }
            ],
            "versions": [
                "1.1.1-r0",
                "1.1.1-r1",
                "1.1.1-r2",
                "1.1.1-r3",
                "1.1.1-r4",
                "1.1.1-r5",
                "1.1.1a-r0",
                "1.1.1a-r1",
                "1.1.1b-r0",
                "1.1.1b-r1",
                "1.1.1c-r0",
                "1.1.1c-r1",
                "1.1.1d-r1",
                "1.1.1d-r2",
                "1.1.1d-r3",
                "1.1.1d-r4",
                "1.1.1d-r5",
                "1.1.1e-r0",
                "1.1.1f-r0",
                "1.1.1g-r0",
                "1.1.1h-r0",
                "1.1.1i-r0",
                "1.1.1j-r0",
                "1.1.1k-r0",
                "1.1.1k-r1"
            ],
            "database_specific": {
                "source": "https://storage.googleapis.com/cve-osv-conversion/alpine/ALPINE-CVE-2021-3711.json"
            }
        },
        {
            "package": {
                "name": "openssl",
                "ecosystem": "Alpine:v3.21",
                "purl": "pkg:apk/alpine/openssl?arch=source"
            },
            "ranges": [
                {
                    "type": "ECOSYSTEM",
                    "events": [
                        {
                            "introduced": "0"
                        },
                        {
                            "fixed": "1.1.1l-r0"
                        }
                    ]
                }
            ],
            "versions": [
                "1.1.1-r0",
                "1.1.1-r1",
                "1.1.1-r2",
                "1.1.1-r3",
                "1.1.1-r4",
                "1.1.1-r5",
                "1.1.1a-r0",
                "1.1.1a-r1",
                "1.1.1b-r0",
                "1.1.1b-r1",
                "1.1.1c-r0",
                "1.1.1c-r1",
                "1.1.1d-r1",
                "1.1.1d-r2",
                "1.1.1d-r3",
                "1.1.1d-r4",
                "1.1.1d-r5",
                "1.1.1e-r0",
                "1.1.1f-r0",
                "1.1.1g-r0",
                "1.1.1h-r0",
                "1.1.1i-r0",
                "1.1.1j-r0",
                "1.1.1k-r0",
                "1.1.1k-r1"
            ],
            "database_specific": {
                "source": "https://storage.googleapis.com/cve-osv-conversion/alpine/ALPINE-CVE-2021-3711.json"
            }
        },
        {
            "package": {
                "name": "openssl",
                "ecosystem": "Alpine:v3.22",
                "purl": "pkg:apk/alpine/openssl?arch=source"
            },
            "ranges": [
                {
                    "type": "ECOSYSTEM",
                    "events": [
                        {
                            "introduced": "0"
                        },
                        {
                            "fixed": "1.1.1l-r0"
                        }
                    ]
                }
            ],
            "versions": [
                "1.1.1-r0",
                "1.1.1-r1",
                "1.1.1-r2",
                "1.1.1-r3",
                "1.1.1-r4",
                "1.1.1-r5",
                "1.1.1a-r0",
                "1.1.1a-r1",
                "1.1.1b-r0",
                "1.1.1b-r1",
                "1.1.1c-r0",
                "1.1.1c-r1",
                "1.1.1d-r1",
                "1.1.1d-r2",
                "1.1.1d-r3",
                "1.1.1d-r4",
                "1.1.1d-r5",
                "1.1.1e-r0",
                "1.1.1f-r0",
                "1.1.1g-r0",
                "1.1.1h-r0",
                "1.1.1i-r0",
                "1.1.1j-r0",
                "1.1.1k-r0",
                "1.1.1k-r1"
            ],
            "database_specific": {
                "source": "https://storage.googleapis.com/cve-osv-conversion/alpine/ALPINE-CVE-2021-3711.json"
            }
        },
        {
            "package": {
                "name": "openssl",
                "ecosystem": "Alpine:v3.23",
                "purl": "pkg:apk/alpine/openssl?arch=source"
            },
            "ranges": [
                {
                    "type": "ECOSYSTEM",
                    "events": [
                        {
                            "introduced": "0"
                        },
                        {
                            "fixed": "1.1.1l-r0"
                        }
                    ]
                }
            ],
            "versions": [
                "1.1.1-r0",
                "1.1.1-r1",
                "1.1.1-r2",
                "1.1.1-r3",
                "1.1.1-r4",
                "1.1.1-r5",
                "1.1.1a-r0",
                "1.1.1a-r1",
                "1.1.1b-r0",
                "1.1.1b-r1",
                "1.1.1c-r0",
                "1.1.1c-r1",
                "1.1.1d-r1",
                "1.1.1d-r2",
                "1.1.1d-r3",
                "1.1.1d-r4",
                "1.1.1d-r5",
                "1.1.1e-r0",
                "1.1.1f-r0",
                "1.1.1g-r0",
                "1.1.1h-r0",
                "1.1.1i-r0",
                "1.1.1j-r0",
                "1.1.1k-r0",
                "1.1.1k-r1"
            ],
            "database_specific": {
                "source": "https://storage.googleapis.com/cve-osv-conversion/alpine/ALPINE-CVE-2021-3711.json"
            }
        },
        {
            "package": {
                "name": "openssl3",
                "ecosystem": "Alpine:v3.15",
                "purl": "pkg:apk/alpine/openssl3?arch=source"
            },
            "ranges": [
                {
                    "type": "ECOSYSTEM",
                    "events": [
                        {
                            "introduced": "0"
                        },
                        {
                            "fixed": "1.1.1l-r0"
                        }
                    ]
                }
            ],
            "versions": [
                "1.1.1-r0",
                "1.1.1-r1",
                "1.1.1-r2",
                "1.1.1-r3",
                "1.1.1-r4",
                "1.1.1-r5",
                "1.1.1a-r0",
                "1.1.1a-r1",
                "1.1.1b-r0",
                "1.1.1b-r1",
                "1.1.1c-r0",
                "1.1.1c-r1",
                "1.1.1d-r1",
                "1.1.1d-r2",
                "1.1.1d-r3",
                "1.1.1d-r4",
                "1.1.1d-r5",
                "1.1.1e-r0",
                "1.1.1f-r0",
                "1.1.1g-r0",
                "1.1.1h-r0",
                "1.1.1i-r0",
                "1.1.1j-r0",
                "1.1.1k-r0",
                "1.1.1k-r1"
            ],
            "database_specific": {
                "source": "https://storage.googleapis.com/cve-osv-conversion/alpine/ALPINE-CVE-2021-3711.json"
            }
        },
        {
            "package": {
                "name": "openssl3",
                "ecosystem": "Alpine:v3.16",
                "purl": "pkg:apk/alpine/openssl3?arch=source"
            },
            "ranges": [
                {
                    "type": "ECOSYSTEM",
                    "events": [
                        {
                            "introduced": "0"
                        },
                        {
                            "fixed": "1.1.1l-r0"
                        }
                    ]
                }
            ],
            "versions": [
                "1.1.1-r0",
                "1.1.1-r1",
                "1.1.1-r2",
                "1.1.1-r3",
                "1.1.1-r4",
                "1.1.1-r5",
                "1.1.1a-r0",
                "1.1.1a-r1",
                "1.1.1b-r0",
                "1.1.1b-r1",
                "1.1.1c-r0",
                "1.1.1c-r1",
                "1.1.1d-r1",
                "1.1.1d-r2",
                "1.1.1d-r3",
                "1.1.1d-r4",
                "1.1.1d-r5",
                "1.1.1e-r0",
                "1.1.1f-r0",
                "1.1.1g-r0",
                "1.1.1h-r0",
                "1.1.1i-r0",
                "1.1.1j-r0",
                "1.1.1k-r0",
                "1.1.1k-r1"
            ],
            "database_specific": {
                "source": "https://storage.googleapis.com/cve-osv-conversion/alpine/ALPINE-CVE-2021-3711.json"
            }
        }
    ],
    "schema_version": "1.7.3",
    "severity": [
        {
            "type": "CVSS_V3",
            "score": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H"
        }
    ]
}